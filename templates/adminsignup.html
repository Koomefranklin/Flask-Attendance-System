{% extends "Admin_base.html" %}
{% block title %}
<script type="text/javascript">
    function check_passwords () {
        const password = document.getElementById("password");
        const confirmed = document.getElementById("confirm-password");
        const submitButton = document.getElementById("register");
        const unmatched = document.getElementById("matching-password");
        const pattern = document.getElementById("password-pattern");
        const upperRegex = /[A-Z]/;
        const lowerRegex = /[a-z]/;
        const specialRegex = /[^\w\s]/;
        const numberRegex = /\d/;
        const lengthRegex = /^.{8,}$/;


        password.addEventListener("input", function () {
            document.getElementById("upper").checked = upperRegex.test(password.value);
            document.getElementById("lower").checked = lowerRegex.test(password.value);
            document.getElementById("special-character").checked = specialRegex.test(password.value);
            document.getElementById("number").checked = numberRegex.test(password.value);
            document.getElementById("length").checked = lengthRegex.test(password.value);
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            let allChecked = true;
            checkboxes.forEach(function(checkbox) {
                if (!checkbox.checked) {
                    allChecked = false;
                }
            });
            confirmed.disabled = !allChecked;
        });


        //listen to changes in the inputs
        password.addEventListener('input', checkValues);
        confirmed.addEventListener('input', checkValues);

        function checkValues() {
            const primaryValue = password.value;
            const secondaryValue = confirmed.value;
            pattern.hidden = false;
            if (primaryValue === secondaryValue){
                confirmed.style.borderColor = 'green';
                unmatched.hidden = true;
                submitButton.disabled = false;
            } else {
                confirmed.style.borderColor = 'red';
                unmatched.hidden = false;
                submitButton.disabled = true;
            }
        }
    }
</script>
{% endblock %}
{% block content %}
<div class = "form">
    <form action = "#" method="POST">
        <label for="name">Full name</label>
        <input type = "text" name = "name" id="name" required autofocus>
        <label for="username">Username</label>
        <input type = "text" name = "username" id="username" required>
        <label for="password">Password</label>
        <input type = "password" name = "password" id="password" required>
        <span id="password-pattern" class="password-pattern" hidden="hidden">
            <p><input type="checkbox" id="upper" disabled readonly>
                <label for="upper">Contains at least 1 upper-case character</label></p>
            <p><input type="checkbox" id="lower" disabled readonly>
                <label for="lower">Contains at least 1 lower-case character</label></p>
            <p><input type="checkbox" id="special-character" disabled readonly>
                <label for="special-character" >Contains a special character</label></p>
            <p><input type="checkbox" id="number" disabled readonly>
                <label for="number">Contains a number</label></p>
            <p><input type="checkbox" id="length" disabled readonly>
                <label for="length">At-least 8 characters long</label></p>
        </span>
        <label for="confirm-password">Confirm New Password</label>
        <input type="password" name="confirm-password" id="confirm-password" required disabled>
        <span id="matching-password" class="matching-password" hidden="hidden">
            Passwords don't match
        </span>
        <button type = "submit" id="register">Register</button>
        <script type="text/javascript">check_passwords()</script>
    </form>
</div>
{% endblock %}